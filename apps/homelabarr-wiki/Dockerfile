## This file is automatically generated (based on release.json)
##
## Do not changes any lines here
##
####################################
# All rights reserved.              #
# started from Zero                 #
# Docker owned dockserver           #
# Docker Maintainer dockserver      #
#####################################
#####################################
# THIS DOCKER IS UNDER LICENSE      #
# NO CUSTOMIZING IS ALLOWED         #
# NO REBRANDING IS ALLOWED          #
# NO CODE MIRRORING IS ALLOWED      #
#####################################
# shellcheck disable=SC2086
# shellcheck disable=SC2046
FROM alpine:3.22.1 as buildstage
LABEL org.opencontainers.image.source="https://github.com/dockserver/container"

ARG TARGETPLATFORM
ARG BUILDPLATFORM

ARG BASEVERSION="3.22.1"
ARG APPVERSION="1.4.72"
ARG WIKIVERSION="9.6.16"
ARG BRANCH="master"

## BUILDSTAGE

RUN \
  echo "**** update packages ****" && \
    apk --quiet --no-cache --no-progress update && \
    apk --quiet --no-cache --no-progress upgrade && \
  echo "**** install build packages ****" && \
    apk add -U --update --no-cache bash git && \
  echo "**** install wiki ****" && \
    mkdir -p /app && git clone --quiet https://github.com/dockserver/dockserver.git /app && \
  echo "*** cleanup system ****" && \
    apk del --quiet --clean-protected --no-progress && \
    rm -f /var/cache/apk/*

## FINALSTAGE

FROM ghcr.io/squidfunk/mkdocs-material:9.6.16

COPY --from=buildstage /app/wiki /docs

RUN \
  echo "**** run wiki packages ****" && \
  python3 -m pip install --upgrade pip && \
  python3 -m pip install --no-warn-script-location --upgrade --force-reinstall -r /docs/requirements.txt && \
  rm -rf /tmp/* && rm -rf /var/cache/apk/* && rm -rf /root/.cache

WORKDIR /docs

EXPOSE 8000
ENTRYPOINT ["mkdocs"]
CMD [ "serve" , "--dev-addr=0.0.0.0:8000" ]
##EOF
